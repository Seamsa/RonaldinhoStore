<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R10 Admin | Dashboard Propri√©taire</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Grotesk:wght@300;400;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        :root { --primary: #E2A900; --dark: #000100; }
        body { background-color: white; color: var(--dark); font-family: 'Space Grotesk', sans-serif; }
        .neo-brutal-shadow { box-shadow: 8px 8px 0px 0px var(--dark); }
        .heading-font { font-family: 'Archivo Black', sans-serif; text-transform: uppercase; }
        .admin-card { border: 4px solid var(--dark); padding: 1.5rem; margin-bottom: 2rem; }
        .input-neo { border: 3px solid black; padding: 0.5rem; width: 100%; font-weight: bold; outline: none; margin-bottom: 1rem; }
        .btn-neo { background: var(--primary); border: 3px solid black; padding: 0.75rem 1.5rem; font-weight: bold; cursor: pointer; transition: all 0.2s; }
        .btn-neo:hover { transform: translate(-2px, -2px); box-shadow: 4px 4px 0px 0px black; }
        .sidebar { background: var(--dark); color: var(--primary); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body class="flex min-h-screen">

    <aside class="w-64 sidebar p-6 flex flex-col border-r-4 border-black">
        <h1 class="heading-font text-2xl mb-10 text-white">R10 <span class="text-[#E2A900]">ADMIN</span></h1>
        <nav class="space-y-4">
            <button onclick="showTab('inventory')" class="w-full text-left font-bold hover:underline">üì¶ INVENTAIRE</button>
            <button onclick="showTab('orders')" class="w-full text-left font-bold hover:underline">üßæ COMMANDES</button>
            <hr class="border-gray-700">
            <a href="index.html" class="text-sm opacity-70">Voir la boutique client</a>
        </nav>
    </aside>

    <main class="flex-grow p-10">
        
        <section id="inventory" class="tab-content active">
            <h2 class="heading-font text-4xl mb-8">Gestion du Stock</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
                <div class="admin-card neo-brutal-shadow bg-[#E2A900]">
                    <h3 class="heading-font text-xl mb-4">Ajouter un Produit</h3>
                    <label class="block font-bold">Nom du mod√®le</label>
                    <input type="text" id="p-name" class="input-neo" placeholder="Ex: R10 Gold '05">
                    
                    <label class="block font-bold">Prix (DA)</label>
                    <input type="number" id="p-price" class="input-neo" placeholder="18000">
                    
                    <label class="block font-bold">URL Image</label>
                    <input type="text" id="p-img" class="input-neo" placeholder="Lien de la photo">
                    
                    <label class="block font-bold">Description</label>
                    <textarea id="p-desc" class="input-neo" rows="3"></textarea>
                    
                    <button onclick="addProduct()" class="w-full bg-black text-white p-3 font-black uppercase">Mettre en rayon</button>
                </div>

                <div class="lg:col-span-2">
                    <div id="admin-product-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>
            </div>
        </section>

        <section id="orders" class="tab-content">
            <h2 class="heading-font text-4xl mb-8">Commandes Re√ßues</h2>
            <div id="admin-orders-list" class="space-y-6"></div>
        </section>

    </main>

    <script>
        // CONFIG FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyCrEd8zSy5bBape6ws3v7mvTavcZfhCKM8",
            authDomain: "r10-store-f6bb3.firebaseapp.com",
            projectId: "r10-store-f6bb3",
            storageBucket: "r10-store-f6bb3.firebasestorage.app",
            messagingSenderId: "154441292816",
            appId: "1:154441292816:web:2390d040a37d7052fdbe95"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // 1. CHANGER D'ONGLET
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
        }

        // 2. AJOUTER PRODUIT FIREBASE
        async function addProduct() {
            const name = document.getElementById('p-name').value;
            const price = parseInt(document.getElementById('p-price').value);
            const img = document.getElementById('p-img').value;
            const desc = document.getElementById('p-desc').value;

            if(!name || !price) return alert("Nom et prix requis !");

            await db.collection("products").add({
                name: name,
                price: price,
                img: img || "https://via.placeholder.com/400",
                longDesc: desc,
                createdAt: new Date()
            });

            alert("Produit ajout√© !");
            document.querySelectorAll('.input-neo').forEach(i => i.value = "");
        }

        // 3. √âCOUTER PRODUITS
        db.collection("products").onSnapshot(snap => {
            const list = document.getElementById('admin-product-list');
            list.innerHTML = snap.docs.map(doc => {
                const p = doc.data();
                return `
                <div class="admin-card bg-white neo-brutal-shadow">
                    <img src="${p.img}" class="w-full h-32 object-cover border-2 border-black mb-2">
                    <h4 class="font-bold">${p.name}</h4>
                    <p>${p.price} DA</p>
                    <button onclick="deleteProduct('${doc.id}')" class="text-red-500 underline text-sm">Supprimer</button>
                </div>`;
            }).join('');
        });

        // 4. √âCOUTER COMMANDES
        db.collection("orders").orderBy("date", "desc").onSnapshot(snap => {
            const list = document.getElementById('admin-orders-list');
            list.innerHTML = snap.docs.map(doc => {
                const o = doc.data();
                return `
                <div class="admin-card bg-white neo-brutal-shadow">
                    <div class="flex justify-between border-b-2 border-black mb-2 pb-2">
                        <span class="heading-font">${o.client}</span>
                        <span class="font-black text-xl">${o.total} DA</span>
                    </div>
                    <p>üìû ${o.phone} | üìç ${o.wilaya}</p>
                    <p class="text-sm italic">${o.adresse}</p>
                    <div class="my-4 bg-gray-100 p-2 text-sm">
                        ${o.items.map(i => `‚Ä¢ ${i.name} (Taille: ${i.size})`).join('<br>')}
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-xs opacity-50">${o.date}</span>
                        <button onclick="deleteOrder('${doc.id}')" class="bg-red-500 text-white px-3 py-1 text-xs font-bold border-2 border-black">EFFACER</button>
                    </div>
                </div>`;
            }).join('');
        });

        async function deleteProduct(id) { if(confirm("Supprimer ?")) await db.collection("products").doc(id).delete(); }
        async function deleteOrder(id) { if(confirm("Effacer la commande ?")) await db.collection("orders").doc(id).delete(); }
    </script>
</body>
</html>